webpackJsonp([7],{e9zL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7t+N"),o=s.n(a),i={data:function(){return{products:[],isLoading:!1,product:{num:1},status:{loadingItem:""},form:{user:{name:"",email:"",tel:"",address:""},message:""},cart:{},coupon_code:""}},methods:{getProducts:function(){var t=this,e="https://vue-course-api.hexschool.io/api/vue-e-shopping/products?page="+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1);t.isLoading=!0,this.$http.get(e).then(function(e){t.products=e.data.products,t.isLoading=!1})},getProduct:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=this,s="https://vue-course-api.hexschool.io/api/vue-e-shopping/product/"+t;e.status.loadingItem=t,this.$http.get(s).then(function(t){e.product=t.data.product,o()("#productModal").modal("show"),e.status.loadingItem=""})},addToCart:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=this,a="https://vue-course-api.hexschool.io/api/vue-e-shopping/cart/";console.log("api:",a),s.status.loadingItem=t;var i={product_id:t,qty:e};this.$http.post(a,{data:i}).then(function(t){console.log("response:",t),s.status.loadingItem="",s.getCart(),o()("#productModal").modal("hide")})},getCart:function(){var t=this;t.isLoading=!0,this.$http.get("https://vue-course-api.hexschool.io/api/vue-e-shopping/cart").then(function(e){t.cart=e.data.data,t.isLoading=!1})},removeCartItem:function(t){var e=this,s="https://vue-course-api.hexschool.io/api/vue-e-shopping/cart/"+t;e.isLoading=!0,this.$http.delete(s).then(function(t){e.getCart(),e.isLoading=!1})},addCouponCode:function(){var t=this,e={code:t.coupon_code};t.isLoading=!0,this.$http.post("https://vue-course-api.hexschool.io/api/vue-e-shopping/coupon",{data:e}).then(function(){t.getCart(),t.isLoading=!1})},createOrder:function(){var t=this,e=this,s=e.form;this.$validator.validate().then(function(a){a?t.$http.post("https://vue-course-api.hexschool.io/api/vue-e-shopping/order",{data:s}).then(function(t){console.log("response:",t),t.data.success&&e.$router.push("/customer_checkout/"+t.data.orderId)}):console.log("欄位不完整:")})}},created:function(){this.getProducts(),this.getCart()}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),s("div",{staticClass:"row mt-4"},t._l(t.products,function(e){return s("div",{key:e.id,staticClass:"col-md-4 mb-4"},[s("div",{staticClass:"card border-0 shadow-sm"},[s("div",{staticStyle:{height:"150px","background-size":"100% 100%","background-position":"center"},style:{backgroundImage:"url("+e.imageUrl+")"}}),t._v(" "),s("div",{staticClass:"card-body"},[s("span",{staticClass:"badge badge-secondary float-right ml-2"},[t._v(t._s(e.category))]),t._v(" "),s("h5",{staticClass:"card-title"},[s("a",{staticClass:"text-dark",attrs:{href:"#"}},[t._v(t._s(e.title))])]),t._v(" "),s("p",{staticClass:"card-text"},[t._v(t._s(e.content))]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between align-items-baseline"},[s("del",{staticClass:"h6"},[t._v("原價 "+t._s(e.origin_price)+" 元")]),t._v(" "),s("div",{staticClass:"h5"},[t._v("現在只要 "+t._s(e.price)+" 元")])])]),t._v(" "),s("div",{staticClass:"card-footer d-flex"},[s("button",{staticClass:"btn btn-outline-secondary btn-sm",attrs:{type:"button"},on:{click:function(s){return t.getProduct(e.id)}}},[t.status.loadingItem===e.id?s("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("\n            查看更多\n          ")]),t._v(" "),s("button",{staticClass:"btn btn-outline-danger btn-sm ml-auto",attrs:{type:"button"},on:{click:function(s){return t.addToCart(e.id)}}},[t.status.loadingItem===e.id?s("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("\n            加到購物車\n          ")])])])])}),0),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v(t._s(t.product.title))]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"modal-body"},[s("img",{staticClass:"img-fluid",attrs:{src:t.product.imageUrl,alt:""}}),t._v(" "),s("blockquote",{staticClass:"blockquote mt-3"},[s("p",{staticClass:"mb-0"},[t._v(t._s(t.product.content))]),t._v(" "),s("footer",{staticClass:"blockquote-footer text-right"},[t._v(t._s(t.product.description))])]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between align-items-baseline"},[t.product.price?t._e():s("div",{staticClass:"h5"},[t._v(t._s(t.product.origin_price)+" 元")]),t._v(" "),t.product.price?s("del",{staticClass:"h6"},[t._v("原價"+t._s(t.product.origin_price)+"元")]):t._e(),t._v(" "),t.product.price?s("div",{staticClass:"h5"},[t._v("現在只要"+t._s(t.product.price)+"元")]):t._e()]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.product.qty,expression:"product.qty"}],staticClass:"form-control mt-3",attrs:{name:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.product,"qty",e.target.multiple?s:s[0])}}},t._l(10,function(e){return s("option",{key:e,domProps:{value:e}},[t._v("選購"+t._s(e)+" "+t._s(t.product.unit))])}),0)]),t._v(" "),s("div",{staticClass:"modal-footer"},[s("div",{staticClass:"text-muted text-nowrap mr-3"},[t._v("\n            小計\n            "),t.product.qty?s("strong",[t._v(t._s(t.product.qty*t.product.price))]):t._e()]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.addToCart(t.product.id,t.product.qty)}}},[s("i",{staticClass:"fas"}),t._v("\n            加到購物車\n          ")])])])])]),t._v(" "),s("div",{staticClass:"mt-5 row justify-content-center"},[s("div",{staticClass:"mt-5 row justify-content-center"},[s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",t._l(t.cart.carts,function(e){return t.cart?s("tr",[s("td",{staticClass:"align-middle"},[s("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(s){return t.removeCartItem(e.id)}}},[s("i",{staticClass:"far fa-trash-alt"})])]),t._v(" "),s("td",{staticClass:"align-middle"},[t._v("\n              "+t._s(e.product.title)+"\n              "),e.coupon?s("div",{staticClass:"text-success"},[t._v("\n                已套用優惠券\n              ")]):t._e()]),t._v(" "),s("td",{staticClass:"align-middle"},[t._v(t._s(e.qty)+"/"+t._s(e.product.unit))]),t._v(" "),s("td",{staticClass:"align-middle text-right"},[t._v(t._s(e.final_total))])]):t._e()}),0),t._v(" "),s("tfoot",[s("tr",[s("td",{staticClass:"text-right",attrs:{colspan:"3"}},[t._v("總計")]),t._v(" "),s("td",{staticClass:"text-right"},[t._v(t._s(t.cart.total))])]),t._v(" "),t.cart.total!==t.cart.final_total?s("tr",[s("td",{staticClass:"text-right text-success",attrs:{colspan:"3"}},[t._v("折扣價")]),t._v(" "),s("td",{staticClass:"text-right text-success"},[t._v(t._s(t.cart.final_total))])]):t._e()])]),t._v(" "),s("div",{staticClass:"input-group mb-3 input-group-sm"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{input:function(e){e.target.composing||(t.coupon_code=e.target.value)}}}),t._v(" "),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:t.addCouponCode}},[t._v("\n            套用優惠碼\n          ")])])])])]),t._v(" "),s("div",{staticClass:"my-5 row justify-content-center"},[s("form",{staticClass:"col-md-6",on:{submit:function(e){return e.preventDefault(),t.createOrder(e)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"useremail"}},[t._v("Email")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"},{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("email")},attrs:{type:"email",name:"email",id:"useremail",placeholder:"請輸入 Email"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),t._v(" "),t.errors.has("email")?s("span",{staticClass:"text-danger"},[t._v(t._s(t.errors.first("email")))]):t._e()]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"username"}},[t._v("收件人姓名")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("name")},attrs:{type:"text",name:"name",id:"username",placeholder:"輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),t._v(" "),t.errors.has("name")?s("span",{staticClass:"text-danger"},[t._v("姓名必須輸入")]):t._e()]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"usertel"}},[t._v("收件人電話")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",attrs:{type:"tel",id:"usertel",name:"tel",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),t._v(" "),t.errors.has("tel")?s("span",{staticClass:"text-danger"},[t._v("電話未填")]):t._e()]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"useraddress"}},[t._v("收件人地址")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",attrs:{type:"address",name:"address",id:"useraddress",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),t._v(" "),t.errors.has("address")?s("span",{staticClass:"text-danger"},[t._v("地址欄位不得留空")]):t._e()]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"useraddress"}},[t._v("留言")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"message",id:"",cols:"30",rows:"10"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),t._v(" "),t._m(2)])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("th"),this._v(" "),e("th",[this._v("品名")]),this._v(" "),e("th",[this._v("數量")]),this._v(" "),e("th",[this._v("單價")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-right"},[e("button",{staticClass:"btn btn-danger"},[this._v("送出訂單")])])}]},n=s("VU/8")(i,r,!1,null,null,null);e.default=n.exports}});
//# sourceMappingURL=7.6aa46ff093a87ada501d.js.map